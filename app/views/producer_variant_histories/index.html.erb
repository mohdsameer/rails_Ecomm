<div class="hero_wrapper">
  <div class="inventory_page_wrapper">
    <%= render "shared/sidebar" %>

    <div class="inventory_panel_wrapper">
      <div class="panel_header">
        <div class="header_box">
          <div class="create_wrap">
            <div class="create_content">
              <%= image_tag "ic_plus", class: "plus_icon" %>
              <%= link_to 'Create Manual Order', new_order_path , class: 'create_text' %>
            </div>

            <div class="create_bell_box">
              <%= image_tag "ic_notifications", class:"create_bell_icon" %>

              <div class="create_notification">
                <p class="notification_text">1</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="inventory_box inventory_history_box">
        <div class="inventory_content_box">
          <div class="inventory_table_wrap">
            <div class="inventory_table">
              <div class="thead">
                <div class="th one">Product Id</div>
                <div class="th two">Product photo</div>
                <div class="th three">Product Detail</div>
                <div class="th four">Inventory Change</div>
                <div class="th five">Qty Change</div>
                <div class="th six">Update Reason</div>
                <div class="th seven">Tracking N</div>
                <div class="th eight">Updated By</div>
                <div class="th nine">Date</div>
              </div>

              <div class="tbody">
                <% @producer_variant_histories.each do |history| %>
                  <% producer_variant = history.producers_variant %>
                  <% variant = producer_variant.variant %>
                  <% product = variant.product %>

                  <div class="tbody_row">
                    <div class="td one"><%= variant.id %></div>

                    <div class="td two">
                      <div class="product_img">
                        <% if variant.image.attached? %>
                          <%= image_tag variant.image %>
                        <% elsif product.image.attached? %>
                          <%= image_tag product.image %>
                        <% else %>
                          <%= image_tag asset_path('dummy-product.png') %>
                        <% end %> 
                      </div>
                    </div>

                    <div class="td three">
                      <div class="product_details_box">
                        <div class="name"><b><%= product.name %></b></div>
                        <div class="brand"><b>Brand:</b> <%= product.brand_name %></div>
                        <div class="sku"><b>SKU:</b> <%= variant.real_variant_sku %></div>
                        <div class="color"><b>color:</b> <%= variant.color %></div>
                        <div class="size"><b>size:</b> <%= variant.size %></div>
                      </div>
                    </div>

                    <div class="td four">
                      <div class="arrow_indicator">
                        <% if history.decreased? %>
                          <%= image_tag 'down.png', alt: 'icon' %>
                          <div class="icon_text"><%= history.prev_inventory %> to <%= history.new_inventory %></div>
                        <% elsif history.increased? %>
                          <%= image_tag 'up.png', alt: 'icon' %>
                          <div class="icon_text green_text"><%= history.prev_inventory %> to <%= history.new_inventory %></div>
                        <% end %>
                      </div>
                    </div>

                    <div class="td five">
                      <div class="arrow_indicator">
                        <% if history.decreased? %>
                          <%= image_tag 'down.png', alt: 'icon' %>
                          <div class="icon_text"><%= history.inventory_margin %></div>
                        <% elsif history.increased? %>
                          <%= image_tag 'up.png', alt: 'icon' %>
                          <div class="icon_text green_text"><%= history.inventory_margin %></div>
                        <% end %>
                      </div>
                    </div>

                    <div class="td six d-flex flex-column">
                      <div><%= history.reason.present? ? history.reason : "-" %></div>

                      <% if history.invoice_no.present? %>
                        <div class="text-bold">Invoice No: <%= history.invoice_no %></div>
                      <% end %>
                    </div>

                    <div class="td seven"><%= history.tracking_no.present? ? history.tracking_no : "-" %></div>

                    <div class="td eight">
                      <%= history.user.name %>
                    </div>

                    <div class="td nine">
                      <%= history.created_at.strftime('%d/%m/%Y') %>
                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          </div>

          <div class="table_footer_wrap">
            <%= render 'shared/pagination', records: @producer_variant_histories, per_page: params[:per_page] %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
