<turbo-frame id="on-hold-order-modal">
  <div id="on-hold-order-modal" class="on-hold-order-modal" data-controller="modals" data-modals-modal-id-value="on-hold-order-modal" >
    <div class="on-hold-order-outer">
      <div class="on_hold_pop_wrapper">

        <%= link_to close_modal_path(modal_id: 'on-hold-order-modal'), data: { 'turbo-method': :post }, class: 'close_popup', id: 'close_status_popup' do %>
          <%= image_tag "close.png", alt: "icon", class: 'close_hold' %>
        <% end %>

        <div class="on_hold_header">
          <div class="header_section">
            <div class="header_id">Order ID: <%= @order.id %></div>
            <div class="yellow_badge">
              <div><%= @order.order_status %></div>
            </div>
          </div>
          <div class="header_section">
            <div class="icon_wrap">
              <% if @order.assign_details.present? %>
                <div class="wrap_text"><%= @order.assign_details.first.designer.name %></div>
                <% if @order.order_edit_status.eql?("completed")%>
                  <span><%= image_tag 'complete.png', alt: 'icon'%></span>
                <% else %>
                  <span><%= image_tag 'incomplete.png', alt: 'icon'%></span>
                <% end %>
              <% else %>
                <%= "Designer is not assign" %>
              <% end %>
            </div>
            <div>
              <%= link_to order_slip_order_path(@order, format: :pdf), class: "slip_btn_wrap" do %>
                Download slip
                <svg class="slip_icon" xmlns="http://www.w3.org/2000/svg" width="25" height="24" viewBox="0 0 25 24" fill="none">
                  <path d="M4.5 19C4.5 18.4477 4.94772 18 5.5 18H19.5C20.0523 18 20.5 18.4477 20.5 19C20.5 19.5523 20.0523 20 19.5 20H5.5C4.94772 20 4.5 19.5523 4.5 19Z" fill="black"/>
                  <path d="M5.5 20C4.94772 20 4.5 19.5523 4.5 19V17C4.5 16.4477 4.94772 16 5.5 16C6.05228 16 6.5 16.4477 6.5 17V19C6.5 19.5523 6.05228 20 5.5 20Z" fill="black"/>
                  <path d="M19.5 20C18.9477 20 18.5 19.5523 18.5 19V17C18.5 16.4477 18.9477 16 19.5 16C20.0523 16 20.5 16.4477 20.5 17V19C20.5 19.5523 20.0523 20 19.5 20Z" fill="black"/>
                  <path d="M12.5 15C12.2927 15.0016 12.09 14.9387 11.92 14.82L7.92 12C7.47119 11.6816 7.36393 11.0604 7.68 10.61C7.83307 10.3916 8.06708 10.2433 8.32998 10.1982C8.59289 10.1532 8.86291 10.215 9.08 10.37L12.5 12.76L15.9 10.2C16.3418 9.86863 16.9686 9.95817 17.3 10.4C17.6314 10.8418 17.5418 11.4686 17.1 11.8L13.1 14.8C12.9269 14.9298 12.7164 15 12.5 15Z" fill="black"/>
                  <path d="M12.5 13C11.9477 13 11.5 12.5523 11.5 12V4C11.5 3.44772 11.9477 3 12.5 3C13.0523 3 13.5 3.44772 13.5 4V12C13.5 12.5523 13.0523 13 12.5 13Z" fill="black"/>
                </svg>
              <% end %>
            </div>
            <!-- <div class="slip_btn_wrap edit_btn"> -->
              <!-- <div class="slip_text">edit slip</div>   to be uncommented soon when the design is available-->
            <!-- </div> -->
          </div>
        </div>

        <div class="create_date"><%= @order.order_date_with_time %></div>

        <div class="order_info_section">
          <div class="etsy_box">
            ETSY Order ID: <%= @order.etsy_order_id %>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="25" height="24" viewBox="0 0 25 24" fill="none">
              <path d="M20.5 11C20.2348 11 19.9804 11.1054 19.7929 11.2929C19.6054 11.4804 19.5 11.7348 19.5 12V18C19.5 18.2652 19.3946 18.5196 19.2071 18.7071C19.0196 18.8946 18.7652 19 18.5 19H6.5C6.23478 19 5.98043 18.8946 5.79289 18.7071C5.60536 18.5196 5.5 18.2652 5.5 18V6C5.5 5.73478 5.60536 5.48043 5.79289 5.29289C5.98043 5.10536 6.23478 5 6.5 5H12.5C12.7652 5 13.0196 4.89464 13.2071 4.70711C13.3946 4.51957 13.5 4.26522 13.5 4C13.5 3.73478 13.3946 3.48043 13.2071 3.29289C13.0196 3.10536 12.7652 3 12.5 3H6.5C5.70435 3 4.94129 3.31607 4.37868 3.87868C3.81607 4.44129 3.5 5.20435 3.5 6V18C3.5 18.7956 3.81607 19.5587 4.37868 20.1213C4.94129 20.6839 5.70435 21 6.5 21H18.5C19.2956 21 20.0587 20.6839 20.6213 20.1213C21.1839 19.5587 21.5 18.7956 21.5 18V12C21.5 11.7348 21.3946 11.4804 21.2071 11.2929C21.0196 11.1054 20.7652 11 20.5 11Z" fill="#212B36"/>
              <path d="M16.5 5H18.08L11.79 11.28C11.6963 11.373 11.6219 11.4836 11.5711 11.6054C11.5203 11.7273 11.4942 11.858 11.4942 11.99C11.4942 12.122 11.5203 12.2527 11.5711 12.3746C11.6219 12.4964 11.6963 12.607 11.79 12.7C11.883 12.7937 11.9936 12.8681 12.1154 12.9189C12.2373 12.9697 12.368 12.9958 12.5 12.9958C12.632 12.9958 12.7627 12.9697 12.8846 12.9189C13.0064 12.8681 13.117 12.7937 13.21 12.7L19.5 6.42V8C19.5 8.26522 19.6054 8.51957 19.7929 8.70711C19.9804 8.89464 20.2348 9 20.5 9C20.7652 9 21.0196 8.89464 21.2071 8.70711C21.3946 8.51957 21.5 8.26522 21.5 8V4C21.5 3.73478 21.3946 3.48043 21.2071 3.29289C21.0196 3.10536 20.7652 3 20.5 3H16.5C16.2348 3 15.9804 3.10536 15.7929 3.29289C15.6054 3.48043 15.5 3.73478 15.5 4C15.5 4.26522 15.6054 4.51957 15.7929 4.70711C15.9804 4.89464 16.2348 5 16.5 5Z" fill="#212B36"/>
            </svg>
          </div>

          <% if @order.note_to_seller.present? %>
            <div class="note_seller">
              Note to Seller: <%= @order.note_to_seller %>
            </div>
          <% end %>

          <div class="details_table_wrapper">
            <div class="details_box">
              <div class="detils_header">Customer</div>
              <div class="details_panel">
                <div class=""><%= @order.address&.fullname %></div>
              </div>
            </div>
            <div class="details_box">
              <div class="detils_header">Shipping</div>
              <div class="details_panel">
                <div class="address_box">
                  <div class="address">
                    <span><%= @order.address&.fullname %></span> 
                    <span><%= @order.address&.to_str %></span>
                  </div>

                  <div class="shipping"><b>Requested Shipping Method:</b> <%= @order.etsy_requested_shipping_method %></div>
                </div>
              </div>
            </div>
            <div class="details_box">
              <div class="detils_header">Billing Info</div>

              <% if @order.is_etsy_imported? %>
                <div class="details_panel">
                  <table>
                    <tr>
                      <td>Item(s) Total:</td>
                      <td>$<%= @order.etsy_items_total %></td>
                    </tr>
                    <tr>
                      <td>Shop Discount:</td>
                      <td class="red_text">-$<%= @order.etsy_shop_discount %></td>
                    </tr>
                    <tr>
                      <td>Subtotal:</td>
                      <td>$<%= @order.etsy_subtotal %></td>
                    </tr>
                    <tr>
                      <td>Sales Tax:</td>
                      <td>$<%= @order.etsy_sales_tax %></td>
                    </tr>
                    <tr>
                      <td>Shipping price:</td>
                      <td>$<%= @order.etsy_shipping_price %></td>
                    </tr>
                    <tr>
                      <td>Order Total:</td>
                      <td>$<%= @order.etsy_order_total %></td>
                    </tr>
                  </table>
                </div>
              <% else %>
                <div class="billing_info">
                  <div class="left_text">
                    <div>Production Cost:</div>
                    <div>Shipping Cost:</div>
                    <div class="fw-bold">Total Cost:</div>
                  </div>
                  <div class="right_text">
                    <div>USD <%= @order.price %></div>
                    <% if @order.shipping_cost.present? %>
                      <div>USD <%= @order.shipping_cost %></div>
                      <div class="fw-bold">USD <%= @order.total_cost %></div>
                    <% else %>
                      <div>-</div>
                      <div class="fw-bold">USD <%= @order.price %></div>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>

          <div class="details_section">
            <div class="details_header">
              <div class="number">No.</div>
              <div class="head_text w-100">Product & Personalization Info</div>
            </div>

            <% if @order.is_etsy_imported? %>
              <% @order.transactions_json.each_with_index do |etsy_transaction, index| %>
                <div class="details_body">
                  <div class="left"><%= index + 1 %></div>
                  <div class="right">
                    <div class="right_big"><%= etsy_transaction["title"] %></div>
                    <div class="right_normal text_black">SKU: <%= etsy_transaction["sku"] %></div>
                    <div class="right_normal text_black">Quantity: <%= etsy_transaction["quantity"] %></div>
                    <% if etsy_transaction["variations"].present? %>
                      <% etsy_transaction["variations"].each do |etsy_variation| %>
                        <div class="right_normal"><%= etsy_variation["formatted_name"] %>:<span><%= etsy_variation["formatted_value"] %></span> </div>
                      <% end %>
                    <% end %>
                    
                    <% if etsy_transaction["product_data"].present? %>
                      <% etsy_transaction["product_data"].each do |etsy_product_data| %>
                        <div class="right_normal"><%= etsy_product_data["property_name"] %>: <br>
                          <%= etsy_product_data["values"]&.join(", ") %>
                        </div>
                      <% end %>
                    <% end %>
                  </div>
                </div>
              <% end %>
            <% else %>
              <% @order.order_products.each_with_index do |order_product, index| %>
                <div class="details_body">
                  <div class="left"><%= index + 1 %></div>
                  <div class="right">
                    <div class="right_big"><%= order_product.product.name %></div>
                    <div class="right_small">(<%= order_product.product.name %>)</div>
                    <div class="right_normal text_black">ETSY SKU: <%= order_product.variant.real_variant_sku %></div>
                    <div class="right_normal text_black">Quantity: <%= order_product.product_quantity %></div>
                    <div class="right_normal">Design Style:<span>Design 1 - YT114-10</span> </div>
                    <div class="right_normal">Brand / Color:<span><%= order_product.product.brand_name %> - <%= order_product.variant.color %></span> </div>
                    <div class="right_normal">Personalization: <br><span>Font: Azonix <br> Text: Jack’s Daily Cup</span> </div>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
          <div class="bottom_line">...</div>
        </div>
      </div>
    </div>
  </div>
</turbo-frame>
